(()=>{"use strict";const e=window.React,t=window.wp.i18n,n=window.wc.wcBlocksRegistry,s=window.wp.htmlEntities,r=window.wc.wcSettings,o=window.wp.element,a=t=>{const{description:n,settings:s}=t,r=(0,o.useRef)(null),a=(0,o.useRef)(!1),c=(0,o.useRef)(null),{eventRegistration:i,emitResponse:m}=t,{onPaymentSetup:l,onCheckoutValidation:d}=i;return(0,o.useEffect)((()=>{var e;showOmiseEmbeddedCardForm({element:r.current,publicKey:s.public_key,hideRememberCard:!s.user_logged_in,locale:s.lcoale,theme:null!==(e=s.card_form_theme)&&void 0!==e?e:"light",design:s.form_design,brandIcons:s.card_brand_icons,onSuccess:e=>{console.log(e),e.remember&&(a.current=e.remember),c.current=e.token},onError:e=>{console.error(e)}})}),[]),(0,o.useEffect)((()=>d((()=>(OmiseCard.requestCardToken(),!0)))),[d]),(0,o.useEffect)((()=>{const e=l((async()=>await new Promise((e=>{const t=setInterval((()=>{if(c.current&&""!==c.current.value){clearInterval(t);try{const t={type:m.responseTypes.SUCCESS,meta:{paymentMethodData:{omise_save_customer_card:a.current.value,omise_token:c.current}}};e(t)}catch(t){const n={type:m.responseTypes.ERROR,message:t.message};e(n)}}}),1e3)}))));return()=>e()}),[m.responseTypes.ERROR,m.responseTypes.SUCCESS,l]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)("p",null,n),(0,e.createElement)("div",{ref:r,id:"omise-card",style:{width:"100%"}}),(0,e.createElement)("input",{type:"hidden",name:"omise_save_customer_card",id:"omise_save_customer_card"}),(0,e.createElement)("input",{type:"hidden",className:"omise_token",name:"omise_token"}))},c=(0,r.getSetting)("omise_data",{}),i=(0,t.__)("Credit/Debit card","omise"),m=(0,s.decodeEntities)(c.title)||i;window.OMISE_CUSTOM_FONT_OTHER="Other";const l=t=>(0,e.createElement)(a,{...t,description:(0,s.decodeEntities)(c.description||""),settings:c});(0,n.registerPaymentMethod)({name:c.name,label:(0,e.createElement)((t=>{const{PaymentMethodLabel:n}=t.components;return(0,e.createElement)(n,{text:m})}),null),content:(0,e.createElement)(l,null),edit:(0,e.createElement)(l,null),canMakePayment:()=>!0,ariaLabel:m,supports:{features:c.supports}})})();